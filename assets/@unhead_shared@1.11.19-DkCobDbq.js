const g=new Set(["title","titleTemplate","script","style","noscript"]),M=new Set(["base","meta","link","style","script","noscript"]),T=new Set(["title","titleTemplate","templateParams","base","htmlAttrs","bodyAttrs","meta","link","style","script","noscript"]),b=new Set(["base","title","titleTemplate","bodyAttrs","htmlAttrs","templateParams"]),h=new Set(["tagPosition","tagPriority","tagDuplicateStrategy","children","innerHTML","textContent","processTemplateParams"]),_=typeof window<"u";function x(e){return e}function u(e){let t=9;for(let r=0;r<e.length;)t=Math.imul(t^e.charCodeAt(r++),9**9);return((t^t>>>9)+65536).toString(16).substring(1,8).toLowerCase()}function L(e){if(e._h)return e._h;if(e._d)return u(e._d);let t=`${e.tag}:${e.textContent||e.innerHTML||""}:`;for(const r in e.props)t+=`${r}:${String(e.props[r])},`;return u(t)}function S(e,t){return e instanceof Promise?e.then(t):t(e)}function l(e,t,r,s){const i=s||P(typeof t=="object"&&typeof t!="function"&&!(t instanceof Promise)?{...t}:{[e==="script"||e==="noscript"||e==="style"?"innerHTML":"textContent"]:t},e==="templateParams"||e==="titleTemplate");if(i instanceof Promise)return i.then(o=>l(e,t,r,o));const n={tag:e,props:i};for(const o of h){const c=n.props[o]!==void 0?n.props[o]:r[o];c!==void 0&&((!(o==="innerHTML"||o==="textContent"||o==="children")||g.has(n.tag))&&(n[o==="children"?"innerHTML":o]=c),delete n.props[o])}return n.props.body&&(n.tagPosition="bodyClose",delete n.props.body),n.tag==="script"&&typeof n.innerHTML=="object"&&(n.innerHTML=JSON.stringify(n.innerHTML),n.props.type=n.props.type||"application/json"),Array.isArray(n.props.content)?n.props.content.map(o=>({...n,props:{...n.props,content:o}})):n}function w(e,t){var s;const r=e==="class"?" ":";";return t&&typeof t=="object"&&!Array.isArray(t)&&(t=Object.entries(t).filter(([,i])=>i).map(([i,n])=>e==="style"?`${i}:${n}`:i)),(s=String(Array.isArray(t)?t.join(r):t))==null?void 0:s.split(r).filter(i=>!!i.trim()).join(r)}function y(e,t,r,s){for(let i=s;i<r.length;i+=1){const n=r[i];if(n==="class"||n==="style"){e[n]=w(n,e[n]);continue}if(e[n]instanceof Promise)return e[n].then(o=>(e[n]=o,y(e,t,r,i)));if(!t&&!h.has(n)){const o=String(e[n]),c=n.startsWith("data-");o==="true"||o===""?e[n]=c?"true":!0:e[n]||(c&&o==="false"?e[n]="false":delete e[n])}}}function P(e,t=!1){const r=y(e,t,Object.keys(e),0);return r instanceof Promise?r.then(()=>e):e}const A=10;function m(e,t,r){for(let s=r;s<t.length;s+=1){const i=t[s];if(i instanceof Promise)return i.then(n=>(t[s]=n,m(e,t,s)));Array.isArray(i)?e.push(...i):e.push(i)}}function j(e){const t=[],r=e.resolvedInput;for(const i in r){if(!Object.prototype.hasOwnProperty.call(r,i))continue;const n=r[i];if(!(n===void 0||!T.has(i))){if(Array.isArray(n)){for(const o of n)t.push(l(i,o,e));continue}t.push(l(i,n,e))}}if(t.length===0)return[];const s=[];return S(m(s,t,0),()=>s.map((i,n)=>(i._e=e._i,e.mode&&(i._m=e.mode),i._p=(e._i<<A)+n,i)))}const v=new Set(["onload","onerror","onabort","onprogress","onloadstart"]),p={base:-10,title:10},d={critical:-80,high:-10,low:20};function E(e){const t=e.tagPriority;if(typeof t=="number")return t;let r=100;return e.tag==="meta"?e.props["http-equiv"]==="content-security-policy"?r=-30:e.props.charset?r=-20:e.props.name==="viewport"&&(r=-15):e.tag==="link"&&e.props.rel==="preconnect"?r=20:e.tag in p&&(r=p[e.tag]),t&&t in d?r+d[t]:r}const I=[{prefix:"before:",offset:-1},{prefix:"after:",offset:1}],H=["name","property","http-equiv"];function O(e){const{props:t,tag:r}=e;if(b.has(r))return r;if(r==="link"&&t.rel==="canonical")return"canonical";if(t.charset)return"charset";if(t.id)return`${r}:id:${t.id}`;for(const s of H)if(t[s]!==void 0)return`${r}:${s}:${t[s]}`;return!1}const a="%separator";function $(e,t,r=!1){var i;let s;if(t==="s"||t==="pageTitle")s=e.pageTitle;else if(t.includes(".")){const n=t.indexOf(".");s=(i=e[t.substring(0,n)])==null?void 0:i[t.substring(n+1)]}else s=e[t];if(s!==void 0)return r?(s||"").replace(/"/g,'\\"'):s||""}const C=new RegExp(`${a}(?:\\s*${a})*`,"g");function W(e,t,r,s=!1){if(typeof e!="string"||!e.includes("%"))return e;let i=e;try{i=decodeURI(e)}catch{}const n=i.match(/%\w+(?:\.\w+)?/g);if(!n)return e;const o=e.includes(a);return e=e.replace(/%\w+(?:\.\w+)?/g,c=>{if(c===a||!n.includes(c))return c;const f=$(t,c.slice(1),s);return f!==void 0?f:c}).trim(),o&&(e.endsWith(a)&&(e=e.slice(0,-a.length)),e.startsWith(a)&&(e=e.slice(a.length)),e=e.replace(C,r).trim()),e}function q(e,t){return e==null?t||null:typeof e=="function"?e(t):e}export{M as H,_ as I,v as N,I as S,E as a,u as b,j as c,x as d,L as h,P as n,W as p,q as r,O as t};
