import{c as M}from"./hookable@5.4.2-48cbdad6.js";import{n as U,g as k,i as L,w as F,a as K,o as W,v as B}from"./@vue_runtime-core@3.2.45-5dec5252.js";import{r as N,u as S,i as q}from"./@vue_reactivity@3.2.45-98cb3bc9.js";const V=["script","style","noscript"],J=["base","meta","link","style","script","noscript"],Q=["base","title","titleTemplate","bodyAttrs","htmlAttrs"];function z(e,r){const{props:t,tag:n}=e;if(Q.includes(n))return n;if(n==="link"&&t.rel==="canonical")return"canonical";if(t.charset)return"charset";const s=["id"];n==="meta"&&s.push("name","property","http-equiv");for(const o of s)if(typeof t[o]<"u"){const i=String(t[o]);return r&&!r(i)?!1:`${n}:${o}:${i}`}return!1}const _=(e,r)=>{const{tag:t,$el:n}=e;n&&(Object.entries(t.props).forEach(([s,o])=>{o=String(o);const i=`attr:${s}`;if(s==="class"){if(!o)return;for(const a of o.split(" ")){const l=`${i}:${a}`;r&&r(e,l,()=>n.classList.remove(a)),n.classList.contains(a)||n.classList.add(a)}return}r&&!s.startsWith("data-h-")&&r(e,i,()=>n.removeAttribute(s)),n.getAttribute(s)!==o&&n.setAttribute(s,o)}),V.includes(t.tag)&&n.innerHTML!==(t.children||"")&&(n.innerHTML=t.children||""))};function w(e){let r=9;for(let t=0;t<e.length;)r=Math.imul(r^e.charCodeAt(t++),9**9);return((r^r>>>9)+65536).toString(16).substring(1,8).toLowerCase()}async function j(e,r={}){var p,g;const t={shouldRender:!0};if(await e.hooks.callHook("dom:beforeRender",t),!t.shouldRender)return;const n=r.document||window.document,s=e._popSideEffectQueue();e.headEntries().map(c=>c._sde).forEach(c=>{Object.entries(c).forEach(([d,u])=>{s[d]=u})});const o=async c=>{const d=e.headEntries().find(b=>b._i===c._e),u={renderId:c._d||w(JSON.stringify({...c,_e:void 0,_p:void 0})),$el:null,shouldRender:!0,tag:c,entry:d,staleSideEffects:s};return await e.hooks.callHook("dom:beforeRenderTag",u),u},i=[],a={body:[],head:[]},l=(c,d,u)=>{d=`${c.renderId}:${d}`,c.entry&&(c.entry._sde[d]=u),delete s[d]},f=c=>{e._elMap[c.renderId]=c.$el,i.push(c),l(c,"el",()=>{var d;(d=c.$el)==null||d.remove(),delete e._elMap[c.renderId]})};for(const c of await e.resolveTags()){const d=await o(c);if(!d.shouldRender)continue;const{tag:u}=d;if(u.tag==="title"){n.title=u.children||"",i.push(d);continue}if(u.tag==="htmlAttrs"||u.tag==="bodyAttrs"){d.$el=n[u.tag==="htmlAttrs"?"documentElement":"body"],_(d,l),i.push(d);continue}if(d.$el=e._elMap[d.renderId],!d.$el&&u._hash&&(d.$el=n.querySelector(`${(p=u.tagPosition)!=null&&p.startsWith("body")?"body":"head"} > ${u.tag}[data-h-${u._hash}]`)),d.$el){d.tag._d&&_(d),f(d);continue}d.$el=n.createElement(u.tag),_(d),a[(g=u.tagPosition)!=null&&g.startsWith("body")?"body":"head"].push(d)}Object.entries(a).forEach(([c,d])=>{var b;if(!d.length)return;const u=(b=n==null?void 0:n[c])==null?void 0:b.children;if(u){for(const h of[...u].reverse()){const A=h.tagName.toLowerCase();if(!J.includes(A))continue;const R=z({tag:A,props:h.getAttributeNames().reduce((y,m)=>({...y,[m]:h.getAttribute(m)}),{})}),T=d.findIndex(y=>{var m;return y&&(y.tag._d===R||((m=h.isEqualNode)==null?void 0:m.call(h,y.$el)))});if(T!==-1){const y=d[T];y.$el=h,_(y),f(y),delete d[T]}}d.forEach(h=>{if(h.$el){switch(h.tag.tagPosition){case"bodyClose":n.body.appendChild(h.$el);break;case"bodyOpen":n.body.insertBefore(h.$el,n.body.firstChild);break;case"head":default:n.head.appendChild(h.$el);break}f(h)}})}});for(const c of i)await e.hooks.callHook("dom:renderTag",c);Object.values(s).forEach(c=>c())}let v=null;async function G(e,r={}){function t(){return v=null,j(e,r)}const n=r.delayFn||(s=>setTimeout(s,10));return v=v||new Promise(s=>n(()=>s(t())))}const X={__proto__:null,debouncedRenderDOMHead:G,get domUpdatePromise(){return v},hashCode:w,renderDOMHead:j},Y=["title","titleTemplate","base","htmlAttrs","bodyAttrs","meta","link","style","script","noscript"],Z=["tagPosition","tagPriority","tagDuplicateStrategy"];async function x(e,r){const t={tag:e,props:{}};return e==="title"||e==="titleTemplate"?(t.children=r instanceof Promise?await r:r,t):(t.props=await ee({...r}),["children","innerHtml","innerHTML"].forEach(n=>{typeof t.props[n]<"u"&&(t.children=t.props[n],typeof t.children=="object"&&(t.children=JSON.stringify(t.children)),delete t.props[n])}),Object.keys(t.props).filter(n=>Z.includes(n)).forEach(n=>{t[n]=t.props[n],delete t.props[n]}),typeof t.props.class=="object"&&!Array.isArray(t.props.class)&&(t.props.class=Object.keys(t.props.class).filter(n=>t.props.class[n])),Array.isArray(t.props.class)&&(t.props.class=t.props.class.join(" ")),t.props.content&&Array.isArray(t.props.content)?t.props.content.map((n,s)=>{const o={...t,props:{...t.props}};return o.props.content=n,o.key=`${t.props.name||t.props.property}:${s}`,o}):t)}async function ee(e){for(const r of Object.keys(e))e[r]instanceof Promise&&(e[r]=await e[r]),String(e[r])==="true"?e[r]="":String(e[r])==="false"&&delete e[r];return e}const E=e=>{if(typeof e.tagPriority=="number")return e.tagPriority;switch(e.tagPriority){case"critical":return 2;case"high":return 9;case"low":return 12}switch(e.tag){case"base":return-1;case"title":return 1;case"meta":return e.props.charset?-2:e.props["http-equiv"]==="content-security-policy"?0:10;default:return 10}},te=(e,r)=>E(e)-E(r),re=["base","title","titleTemplate","bodyAttrs","htmlAttrs"];function ne(e,r){const{props:t,tag:n}=e;if(re.includes(n))return n;if(n==="link"&&t.rel==="canonical")return"canonical";if(t.charset)return"charset";const s=["id"];n==="meta"&&s.push("name","property","http-equiv");for(const o of s)if(typeof t[o]<"u"){const i=String(t[o]);return r&&!r(i)?!1:`${n}:${o}:${i}`}return!1}const O=(e,r)=>e==null?r||null:typeof e=="function"?e(r):e.replace("%s",r??"");function se(e){let r=e.findIndex(n=>n.tag==="titleTemplate");const t=e.findIndex(n=>n.tag==="title");if(t!==-1&&r!==-1){const n=O(e[r].children,e[t].children);n!==null?e[t].children=n||e[t].children:delete e[t]}else if(r!==-1){const n=O(e[r].children);n!==null&&(e[r].children=n,e[r].tag="title",r=-1)}return r!==-1&&delete e[r],e.filter(Boolean)}const oe=e=>{e=e||{};const r=e.dedupeKeys||["hid","vmid","key"];return{hooks:{"tag:normalise":function({tag:t}){r.forEach(s=>{t.props[s]&&(t.key=t.props[s],delete t.props[s])});const n=t.key?`${t.tag}:${t.key}`:ne(t);n&&(t._d=n)},"tags:resolve":function(t){const n={};t.tags.forEach(s=>{let o=s._d||s._p;const i=n[o];if(i){let a=s==null?void 0:s.tagDuplicateStrategy;if(!a&&(s.tag==="htmlAttrs"||s.tag==="bodyAttrs")&&(a="merge"),a==="merge"){const f=i.props;["class","style"].forEach(p=>{s.props[p]&&f[p]&&(p==="style"&&!f[p].endsWith(";")&&(f[p]+=";"),s.props[p]=`${f[p]} ${s.props[p]}`)}),n[o].props={...f,...s.props};return}else s._e===i._e&&(o=s._d=`${o}:${s._p}`);const l=Object.keys(s.props).length;if((l===0||l===1&&typeof s.props["data-h-key"]<"u")&&!s.children){delete n[o];return}}n[o]=s}),t.tags=Object.values(n)}}}},ie=()=>({hooks:{"tags:resolve":e=>{const r=t=>{var n;return(n=e.tags.find(s=>s._d===t))==null?void 0:n._p};for(const t of e.tags){if(!t.tagPriority||typeof t.tagPriority=="number")continue;const n=[{prefix:"before:",offset:-1},{prefix:"after:",offset:1}];for(const{prefix:s,offset:o}of n)if(t.tagPriority.startsWith(s)){const i=t.tagPriority.replace(s,""),a=r(i);typeof a<"u"&&(t._p=a+o)}}e.tags.sort((t,n)=>t._p-n._p).sort(te)}}}),ae=()=>({hooks:{"tags:resolve":e=>{e.tags=se(e.tags)}}}),de=()=>({hooks:{"tag:normalise":function({tag:e}){typeof e.props.body<"u"&&(e.tagPosition="bodyClose",delete e.props.body)}}}),ce=typeof window<"u",le=()=>({hooks:{"tag:normalise":e=>{var s,o;const{tag:r,entry:t}=e,n=typeof r.props._dynamic<"u";!C.includes(r.tag)||!r.key||(r._hash=w(JSON.stringify({tag:r.tag,key:r.key})),!(ce||(o=(s=D())==null?void 0:s.resolvedOptions)!=null&&o.document)&&(t._m==="server"||n)&&(r.props[`data-h-${r._hash}`]=""))},"tags:resolve":e=>{e.tags=e.tags.map(r=>(delete r.props._dynamic,r))}}}),ue=e=>({hooks:{"entries:updated":function(r){if(typeof(e==null?void 0:e.document)>"u"&&typeof window>"u")return;let t=e==null?void 0:e.delayFn;!t&&typeof requestAnimationFrame<"u"&&(t=requestAnimationFrame),Promise.resolve().then(function(){return X}).then(({debouncedRenderDOMHead:n})=>{n(r,{document:(e==null?void 0:e.document)||window.document,delayFn:t})})}}}),fe=()=>{const e=(r,t)=>{const n={},s={};Object.entries(t.props).forEach(([i,a])=>{i.startsWith("on")&&typeof a=="function"?s[i]=a:n[i]=a});let o;return r==="dom"&&t.tag==="script"&&typeof n.src=="string"&&typeof s.onload<"u"&&(o=n.src,delete n.src),{props:n,eventHandlers:s,delayedSrc:o}};return{hooks:{"ssr:render":function(r){r.tags=r.tags.map(t=>(t.props=e("ssr",t).props,t))},"dom:beforeRenderTag":function(r){const{props:t,eventHandlers:n,delayedSrc:s}=e("dom",r.tag);Object.keys(n).length&&(r.tag.props=t,r.tag._eventHandlers=n,r.tag._delayedSrc=s)},"dom:renderTag":function(r){const t=r.$el;if(!r.tag._eventHandlers||!t)return;const n=r.tag.tag==="bodyAttrs"&&typeof window<"u"?window:t;Object.entries(r.tag._eventHandlers).forEach(([s,o])=>{const i=`${r.tag._d||r.tag._p}:${s}`,a=s.slice(2).toLowerCase(),l=`data-h-${a}`;if(delete r.staleSideEffects[i],t.hasAttribute(l))return;const f=o;t.setAttribute(l,""),n.addEventListener(a,f),r.entry&&(r.entry._sde[i]=()=>{n.removeEventListener(a,f),t.removeAttribute(l)})}),r.tag._delayedSrc&&t.setAttribute("src",r.tag._delayedSrc)}}}};function pe(e){return Array.isArray(e)?e:[e]}const C=["base","meta","link","style","script","noscript"];let I;const he=e=>I=e,D=()=>I,ye=10;async function ge(e){const r=[];return Object.entries(e.resolvedInput||e.input).filter(([t,n])=>typeof n<"u"&&Y.includes(t)).forEach(([t,n])=>{const s=pe(n);r.push(...s.map(o=>x(t,o)).flat())}),(await Promise.all(r)).flat().map((t,n)=>(t._e=e._i,t._p=(e._i<<ye)+n,t))}const me=()=>[oe(),ie(),ae(),le(),fe(),de()],be=(e={})=>[ue({document:e==null?void 0:e.document,delayFn:e==null?void 0:e.domDelayFn})];function _e(e={}){const r=ve({...e,plugins:[...be(e),...(e==null?void 0:e.plugins)||[]]});return he(r),r}function ve(e={}){let r=[],t={},n=0;const s=M();e!=null&&e.hooks&&s.addHooks(e.hooks),e.plugins=[...me(),...(e==null?void 0:e.plugins)||[]],e.plugins.forEach(a=>a.hooks&&s.addHooks(a.hooks));const o=()=>s.callHook("entries:updated",i),i={resolvedOptions:e,headEntries(){return r},get hooks(){return s},use(a){a.hooks&&s.addHooks(a.hooks)},push(a,l){const f={_i:n++,input:a,_sde:{}};return l!=null&&l.mode&&(f._m=l==null?void 0:l.mode),r.push(f),o(),{dispose(){r=r.filter(p=>p._i!==f._i?!0:(t={...t,...p._sde||{}},p._sde={},o(),!1))},patch(p){r=r.map(g=>(g._i===f._i&&(f.input=g.input=p,o()),g))}}},async resolveTags(){const a={tags:[],entries:[...r]};await s.callHook("entries:resolve",a);for(const l of a.entries)for(const f of await ge(l)){const p={tag:f,entry:l};await s.callHook("tag:normalise",p),a.tags.push(p.tag)}return await s.callHook("tags:resolve",a),a.tags},_elMap:{},_popSideEffectQueue(){const a={...t};return t={},a}};return i.hooks.callHook("init",i),i}function $e(e){return typeof e=="function"?e():S(e)}function $(e,r=""){if(e instanceof Promise)return e;const t=$e(e);if(!e||!t)return t;if(Array.isArray(t))return t.map(n=>$(n,r));if(typeof t=="object"){let n=!1;const s=Object.fromEntries(Object.entries(t).map(([o,i])=>o==="titleTemplate"||o.startsWith("on")?[o,S(i)]:((typeof i=="function"||q(i))&&(n=!0),[o,$(i,o)])));return n&&C.includes(String(r))&&(s._dynamic=!0),s}return t}const Te=B.startsWith("3"),we=typeof window<"u",H="usehead";function P(){return k()&&L(H)||D()}function Se(e={}){const r=_e({...e,domDelayFn:n=>setTimeout(()=>U(()=>n()),10),plugins:[He(),...(e==null?void 0:e.plugins)||[]]}),t={install(n){Te&&(n.config.globalProperties.$unhead=r,n.provide(H,r))}};return r.install=t.install,r}const He=()=>({hooks:{"entries:resolve":function(e){for(const r of e.entries)r.resolvedInput=$(r.input)}}}),je=function(e,r){e.mixin({beforeCreate(){const t=this.$options,n=t.provide;t.provide=function(){let s;return typeof n=="function"?s=n.call(this):s=n||{},{...s,[H]:r}}}})};function Pe(e,r={}){const t=P(),n=N({});F(()=>{n.value=$(e)});const s=t.push(n.value,r);return K(n,i=>s.patch(i)),k()&&W(()=>{s.dispose()}),s}function Ae(e,r={}){return P().push(e,r)}function Ce(e,r={}){var n;const t=P();if(t){const s=we||!!((n=t.resolvedOptions)!=null&&n.document);return r.mode==="server"&&s||r.mode==="client"&&!s?void 0:s?Pe(e,r):Ae(e,r)}}export{je as V,Se as c,Ce as u};
