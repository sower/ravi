import{a as q,o as ue}from"./evtd@0.2.4-CI_DDEu_.js";import{j as Te,d as he,p as _,e as Ve,a as Xe}from"./seemly@0.3.8-D9G0Xg2e.js";import{t as Ye,F as ze,C as De,y as W,D as Ee,g as Ie,i as Q,q as Z,H as Fe,p as H,h as z,J as Ne,a as R,m as P,n as _e,M as je,z as Pe,A as qe,G as Ue}from"./@vue_runtime-core@3.5.12-KnjHTw7F.js";import{q as I,v as V}from"./@vue_reactivity@3.5.12-g-Lvtq_S.js";import{u as fe}from"./@css-render_vue3-ssr@0.15.14_vue@3.5.12_typescript@5.6.3_-6IDDgy2s.js";import{h as Ke,u as D,o as Ge,i as Je}from"./vooks@0.2.12_vue@3.5.12_typescript@5.6.3_-D8Rsv1Sm.js";import{z as Qe}from"./vdirs@0.1.8_vue@3.5.12_typescript@5.6.3_-C0KV5pCE.js";import{R as Ze}from"./@juggle_resize-observer@3.4.0-C8OzoCMD.js";import{C as Re}from"./css-render@0.15.14-C5toWlUr.js";function ae(n,e,t="default"){const r=e[t];if(r===void 0)throw new Error(`[vueuc/${n}]: slot[${t}] is empty.`);return r()}function de(n,e=!0,t=[]){return n.forEach(r=>{if(r!==null){if(typeof r!="object"){(typeof r=="string"||typeof r=="number")&&t.push(Ye(String(r)));return}if(Array.isArray(r)){de(r,e,t);return}if(r.type===ze){if(r.children===null)return;Array.isArray(r.children)&&de(r.children,e,t)}else r.type!==De&&t.push(r)}}),t}function pe(n,e,t="default"){const r=e[t];if(r===void 0)throw new Error(`[vueuc/${n}]: slot[${t}] is empty.`);const o=de(r());if(o.length===1)return o[0];throw new Error(`[vueuc/${n}]: slot[${t}] should have exactly one child.`)}let k=null;function Be(){if(k===null&&(k=document.getElementById("v-binder-view-measurer"),k===null)){k=document.createElement("div"),k.id="v-binder-view-measurer";const{style:n}=k;n.position="fixed",n.left="0",n.right="0",n.top="0",n.bottom="0",n.pointerEvents="none",n.visibility="hidden",document.body.appendChild(k)}return k.getBoundingClientRect()}function et(n,e){const t=Be();return{top:e,left:n,height:0,width:0,right:t.width-n,bottom:t.height-e}}function le(n){const e=n.getBoundingClientRect(),t=Be();return{left:e.left-t.left,top:e.top-t.top,bottom:t.height+t.top-e.bottom,right:t.width+t.left-e.right,width:e.width,height:e.height}}function tt(n){return n.nodeType===9?null:n.parentNode}function Ce(n){if(n===null)return null;const e=tt(n);if(e===null)return null;if(e.nodeType===9)return document;if(e.nodeType===1){const{overflow:t,overflowX:r,overflowY:o}=getComputedStyle(e);if(/(auto|scroll|overlay)/.test(t+o+r))return e}return Ce(e)}const Tt=W({name:"Binder",props:{syncTargetWithParent:Boolean,syncTarget:{type:Boolean,default:!0}},setup(n){var e;Ee("VBinder",(e=Ie())===null||e===void 0?void 0:e.proxy);const t=Q("VBinder",null),r=I(null),o=l=>{r.value=l,t&&n.syncTargetWithParent&&t.setTargetRef(l)};let u=[];const p=()=>{let l=r.value;for(;l=Ce(l),l!==null;)u.push(l);for(const x of u)ue("scroll",x,y,!0)},w=()=>{for(const l of u)q("scroll",l,y,!0);u=[]},s=new Set,h=l=>{s.size===0&&p(),s.has(l)||s.add(l)},m=l=>{s.has(l)&&s.delete(l),s.size===0&&w()},y=()=>{Te(d)},d=()=>{s.forEach(l=>l())},c=new Set,v=l=>{c.size===0&&ue("resize",window,a),c.has(l)||c.add(l)},b=l=>{c.has(l)&&c.delete(l),c.size===0&&q("resize",window,a)},a=()=>{c.forEach(l=>l())};return Z(()=>{q("resize",window,a),w()}),{targetRef:r,setTargetRef:o,addScrollListener:h,removeScrollListener:m,addResizeListener:v,removeResizeListener:b}},render(){return ae("binder",this.$slots)}}),zt=W({name:"Target",setup(){const{setTargetRef:n,syncTarget:e}=Q("VBinder");return{syncTarget:e,setTargetDirective:{mounted:n,updated:n}}},render(){const{syncTarget:n,setTargetDirective:e}=this;return n?Fe(pe("follower",this.$slots),[[e]]):pe("follower",this.$slots)}});function me(n,e){console.error(`[vueuc/${n}]: ${e}`)}const{c:A}=Re(),ce="vueuc-style";function ve(n){return n&-n}class Ae{constructor(e,t){this.l=e,this.min=t;const r=new Array(e+1);for(let o=0;o<e+1;++o)r[o]=0;this.ft=r}add(e,t){if(t===0)return;const{l:r,ft:o}=this;for(e+=1;e<=r;)o[e]+=t,e+=ve(e)}get(e){return this.sum(e+1)-this.sum(e)}sum(e){if(e===void 0&&(e=this.l),e<=0)return 0;const{ft:t,min:r,l:o}=this;if(e>o)throw new Error("[FinweckTree.sum]: `i` is larger than length.");let u=e*r;for(;e>0;)u+=t[e],e-=ve(e);return u}getBound(e){let t=0,r=this.l;for(;r>t;){const o=Math.floor((t+r)/2),u=this.sum(o);if(u>e){r=o;continue}else if(u<e){if(t===o)return this.sum(t+1)<=e?t+1:o;t=o}else return o}return t}}function be(n){return typeof n=="string"?document.querySelector(n):n()}const nt=W({name:"LazyTeleport",props:{to:{type:[String,Object],default:void 0},disabled:Boolean,show:{type:Boolean,required:!0}},setup(n){return{showTeleport:Ke(V(n,"show")),mergedTo:H(()=>{const{to:e}=n;return e??"body"})}},render(){return this.showTeleport?this.disabled?ae("lazy-teleport",this.$slots):z(Ne,{disabled:this.disabled,to:this.mergedTo},ae("lazy-teleport",this.$slots)):null}}),G={top:"bottom",bottom:"top",left:"right",right:"left"},ge={start:"end",center:"center",end:"start"},ie={top:"height",bottom:"height",left:"width",right:"width"},rt={"bottom-start":"top left",bottom:"top center","bottom-end":"top right","top-start":"bottom left",top:"bottom center","top-end":"bottom right","right-start":"top left",right:"center left","right-end":"bottom left","left-start":"top right",left:"center right","left-end":"bottom right"},ot={"bottom-start":"bottom left",bottom:"bottom center","bottom-end":"bottom right","top-start":"top left",top:"top center","top-end":"top right","right-start":"top right",right:"center right","right-end":"bottom right","left-start":"top left",left:"center left","left-end":"bottom left"},lt={"bottom-start":"right","bottom-end":"left","top-start":"right","top-end":"left","right-start":"bottom","right-end":"top","left-start":"bottom","left-end":"top"},we={top:!0,bottom:!1,left:!0,right:!1},ye={top:"end",bottom:"start",left:"end",right:"start"};function it(n,e,t,r,o,u){if(!o||u)return{placement:n,top:0,left:0};const[p,w]=n.split("-");let s=w??"center",h={top:0,left:0};const m=(c,v,b)=>{let a=0,l=0;const x=t[c]-e[v]-e[c];return x>0&&r&&(b?l=we[v]?x:-x:a=we[v]?x:-x),{left:a,top:l}},y=p==="left"||p==="right";if(s!=="center"){const c=lt[n],v=G[c],b=ie[c];if(t[b]>e[b]){if(e[c]+e[b]<t[b]){const a=(t[b]-e[b])/2;e[c]<a||e[v]<a?e[c]<e[v]?(s=ge[w],h=m(b,v,y)):h=m(b,c,y):s="center"}}else t[b]<e[b]&&e[v]<0&&e[c]>e[v]&&(s=ge[w])}else{const c=p==="bottom"||p==="top"?"left":"top",v=G[c],b=ie[c],a=(t[b]-e[b])/2;(e[c]<a||e[v]<a)&&(e[c]>e[v]?(s=ye[c],h=m(b,c,y)):(s=ye[v],h=m(b,v,y)))}let d=p;return e[p]<t[ie[p]]&&e[p]<e[G[p]]&&(d=G[p]),{placement:s!=="center"?`${d}-${s}`:d,left:h.left,top:h.top}}function st(n,e){return e?ot[n]:rt[n]}function ut(n,e,t,r,o,u){if(u)switch(n){case"bottom-start":return{top:`${Math.round(t.top-e.top+t.height)}px`,left:`${Math.round(t.left-e.left)}px`,transform:"translateY(-100%)"};case"bottom-end":return{top:`${Math.round(t.top-e.top+t.height)}px`,left:`${Math.round(t.left-e.left+t.width)}px`,transform:"translateX(-100%) translateY(-100%)"};case"top-start":return{top:`${Math.round(t.top-e.top)}px`,left:`${Math.round(t.left-e.left)}px`,transform:""};case"top-end":return{top:`${Math.round(t.top-e.top)}px`,left:`${Math.round(t.left-e.left+t.width)}px`,transform:"translateX(-100%)"};case"right-start":return{top:`${Math.round(t.top-e.top)}px`,left:`${Math.round(t.left-e.left+t.width)}px`,transform:"translateX(-100%)"};case"right-end":return{top:`${Math.round(t.top-e.top+t.height)}px`,left:`${Math.round(t.left-e.left+t.width)}px`,transform:"translateX(-100%) translateY(-100%)"};case"left-start":return{top:`${Math.round(t.top-e.top)}px`,left:`${Math.round(t.left-e.left)}px`,transform:""};case"left-end":return{top:`${Math.round(t.top-e.top+t.height)}px`,left:`${Math.round(t.left-e.left)}px`,transform:"translateY(-100%)"};case"top":return{top:`${Math.round(t.top-e.top)}px`,left:`${Math.round(t.left-e.left+t.width/2)}px`,transform:"translateX(-50%)"};case"right":return{top:`${Math.round(t.top-e.top+t.height/2)}px`,left:`${Math.round(t.left-e.left+t.width)}px`,transform:"translateX(-100%) translateY(-50%)"};case"left":return{top:`${Math.round(t.top-e.top+t.height/2)}px`,left:`${Math.round(t.left-e.left)}px`,transform:"translateY(-50%)"};case"bottom":default:return{top:`${Math.round(t.top-e.top+t.height)}px`,left:`${Math.round(t.left-e.left+t.width/2)}px`,transform:"translateX(-50%) translateY(-100%)"}}switch(n){case"bottom-start":return{top:`${Math.round(t.top-e.top+t.height+r)}px`,left:`${Math.round(t.left-e.left+o)}px`,transform:""};case"bottom-end":return{top:`${Math.round(t.top-e.top+t.height+r)}px`,left:`${Math.round(t.left-e.left+t.width+o)}px`,transform:"translateX(-100%)"};case"top-start":return{top:`${Math.round(t.top-e.top+r)}px`,left:`${Math.round(t.left-e.left+o)}px`,transform:"translateY(-100%)"};case"top-end":return{top:`${Math.round(t.top-e.top+r)}px`,left:`${Math.round(t.left-e.left+t.width+o)}px`,transform:"translateX(-100%) translateY(-100%)"};case"right-start":return{top:`${Math.round(t.top-e.top+r)}px`,left:`${Math.round(t.left-e.left+t.width+o)}px`,transform:""};case"right-end":return{top:`${Math.round(t.top-e.top+t.height+r)}px`,left:`${Math.round(t.left-e.left+t.width+o)}px`,transform:"translateY(-100%)"};case"left-start":return{top:`${Math.round(t.top-e.top+r)}px`,left:`${Math.round(t.left-e.left+o)}px`,transform:"translateX(-100%)"};case"left-end":return{top:`${Math.round(t.top-e.top+t.height+r)}px`,left:`${Math.round(t.left-e.left+o)}px`,transform:"translateX(-100%) translateY(-100%)"};case"top":return{top:`${Math.round(t.top-e.top+r)}px`,left:`${Math.round(t.left-e.left+t.width/2+o)}px`,transform:"translateY(-100%) translateX(-50%)"};case"right":return{top:`${Math.round(t.top-e.top+t.height/2+r)}px`,left:`${Math.round(t.left-e.left+t.width+o)}px`,transform:"translateY(-50%)"};case"left":return{top:`${Math.round(t.top-e.top+t.height/2+r)}px`,left:`${Math.round(t.left-e.left+o)}px`,transform:"translateY(-50%) translateX(-100%)"};case"bottom":default:return{top:`${Math.round(t.top-e.top+t.height+r)}px`,left:`${Math.round(t.left-e.left+t.width/2+o)}px`,transform:"translateX(-50%)"}}}const at=A([A(".v-binder-follower-container",{position:"absolute",left:"0",right:"0",top:"0",height:"0",pointerEvents:"none",zIndex:"auto"}),A(".v-binder-follower-content",{position:"absolute",zIndex:"auto"},[A("> *",{pointerEvents:"all"})])]),Et=W({name:"Follower",inheritAttrs:!1,props:{show:Boolean,enabled:{type:Boolean,default:void 0},placement:{type:String,default:"bottom"},syncTrigger:{type:Array,default:["resize","scroll"]},to:[String,Object],flip:{type:Boolean,default:!0},internalShift:Boolean,x:Number,y:Number,width:String,minWidth:String,containerClass:String,teleportDisabled:Boolean,zindexable:{type:Boolean,default:!0},zIndex:Number,overlap:Boolean},setup(n){const e=Q("VBinder"),t=D(()=>n.enabled!==void 0?n.enabled:n.show),r=I(null),o=I(null),u=()=>{const{syncTrigger:d}=n;d.includes("scroll")&&e.addScrollListener(s),d.includes("resize")&&e.addResizeListener(s)},p=()=>{e.removeScrollListener(s),e.removeResizeListener(s)};R(()=>{t.value&&(s(),u())});const w=fe();at.mount({id:"vueuc/binder",head:!0,anchorMetaName:ce,ssr:w}),Z(()=>{p()}),Ge(()=>{t.value&&s()});const s=()=>{if(!t.value)return;const d=r.value;if(d===null)return;const c=e.targetRef,{x:v,y:b,overlap:a}=n,l=v!==void 0&&b!==void 0?et(v,b):le(c);d.style.setProperty("--v-target-width",`${Math.round(l.width)}px`),d.style.setProperty("--v-target-height",`${Math.round(l.height)}px`);const{width:x,minWidth:F,placement:C,internalShift:ee,flip:U}=n;d.setAttribute("v-placement",C),a?d.setAttribute("v-overlap",""):d.removeAttribute("v-overlap");const{style:B}=d;x==="target"?B.width=`${l.width}px`:x!==void 0?B.width=x:B.width="",F==="target"?B.minWidth=`${l.width}px`:F!==void 0?B.minWidth=F:B.minWidth="";const te=le(d),ne=le(o.value),{left:K,top:X,placement:Y}=it(C,l,te,ee,U,a),i=st(Y,a),{left:f,top:g,transform:M}=ut(Y,ne,l,X,K,a);d.setAttribute("v-placement",Y),d.style.setProperty("--v-offset-left",`${Math.round(K)}px`),d.style.setProperty("--v-offset-top",`${Math.round(X)}px`),d.style.transform=`translateX(${f}) translateY(${g}) ${M}`,d.style.setProperty("--v-transform-origin",i),d.style.transformOrigin=i};P(t,d=>{d?(u(),h()):p()});const h=()=>{_e().then(s).catch(d=>console.error(d))};["placement","x","y","internalShift","flip","width","overlap","minWidth"].forEach(d=>{P(V(n,d),s)}),["teleportDisabled"].forEach(d=>{P(V(n,d),h)}),P(V(n,"syncTrigger"),d=>{d.includes("resize")?e.addResizeListener(s):e.removeResizeListener(s),d.includes("scroll")?e.addScrollListener(s):e.removeScrollListener(s)});const m=Je(),y=D(()=>{const{to:d}=n;if(d!==void 0)return d;m.value});return{VBinder:e,mergedEnabled:t,offsetContainerRef:o,followerRef:r,mergedTo:y,syncPosition:s}},render(){return z(nt,{show:this.show,to:this.mergedTo,disabled:this.teleportDisabled},{default:()=>{var n,e;const t=z("div",{class:["v-binder-follower-container",this.containerClass],ref:"offsetContainerRef"},[z("div",{class:"v-binder-follower-content",ref:"followerRef"},(e=(n=this.$slots).default)===null||e===void 0?void 0:e.call(n))]);return this.zindexable?Fe(t,[[Qe,{enabled:this.mergedEnabled,zIndex:this.zIndex}]]):t}})}});class dt{constructor(){this.handleResize=this.handleResize.bind(this),this.observer=new(typeof window<"u"&&window.ResizeObserver||Ze)(this.handleResize),this.elHandlersMap=new Map}handleResize(e){for(const t of e){const r=this.elHandlersMap.get(t.target);r!==void 0&&r(t)}}registerHandler(e,t){this.elHandlersMap.set(e,t),this.observer.observe(e)}unregisterHandler(e){this.elHandlersMap.has(e)&&(this.elHandlersMap.delete(e),this.observer.unobserve(e))}}const xe=new dt,Me=W({name:"ResizeObserver",props:{onResize:Function},setup(n){let e=!1;const t=Ie().proxy;function r(o){const{onResize:u}=n;u!==void 0&&u(o)}R(()=>{const o=t.$el;if(o===void 0){me("resize-observer","$el does not exist.");return}if(o.nextElementSibling!==o.nextSibling&&o.nodeType===3&&o.nodeValue!==""){me("resize-observer","$el can not be observed (it may be a text node).");return}o.nextElementSibling!==null&&(xe.registerHandler(o.nextElementSibling,r),e=!0)}),Z(()=>{e&&xe.unregisterHandler(t.$el.nextElementSibling)})},render(){return je(this.$slots,"default")}});let J;function ft(){return typeof document>"u"?!1:(J===void 0&&("matchMedia"in window?J=window.matchMedia("(pointer:coarse)").matches:J=!1),J)}let se;function $e(){return typeof document>"u"?1:(se===void 0&&(se="chrome"in window?window.devicePixelRatio:1),se)}const We="VVirtualListXScroll";function ct({columnsRef:n,renderColRef:e,renderItemWithColsRef:t}){const r=I(0),o=I(0),u=H(()=>{const h=n.value;if(h.length===0)return null;const m=new Ae(h.length,0);return h.forEach((y,d)=>{m.add(d,y.width)}),m}),p=D(()=>{const h=u.value;return h!==null?Math.max(h.getBound(o.value)-1,0):0}),w=h=>{const m=u.value;return m!==null?m.sum(h):0},s=D(()=>{const h=u.value;return h!==null?Math.min(h.getBound(o.value+r.value)+1,n.value.length-1):0});return Ee(We,{startIndexRef:p,endIndexRef:s,columnsRef:n,renderColRef:e,renderItemWithColsRef:t,getLeft:w}),{listWidthRef:r,scrollLeftRef:o}}const Se=W({name:"VirtualListRow",props:{index:{type:Number,required:!0},item:{type:Object,required:!0}},setup(){const{startIndexRef:n,endIndexRef:e,columnsRef:t,getLeft:r,renderColRef:o,renderItemWithColsRef:u}=Q(We);return{startIndex:n,endIndex:e,columns:t,renderCol:o,renderItemWithCols:u,getLeft:r}},render(){const{startIndex:n,endIndex:e,columns:t,renderCol:r,renderItemWithCols:o,getLeft:u,item:p}=this;if(o!=null)return o({itemIndex:this.index,startColIndex:n,endColIndex:e,allColumns:t,item:p,getLeft:u});if(r!=null){const w=[];for(let s=n;s<=e;++s){const h=t[s];w.push(r({column:h,left:u(s),item:p}))}return w}return null}}),ht=A(".v-vl",{maxHeight:"inherit",height:"100%",overflow:"auto",minWidth:"1px"},[A("&:not(.v-vl--show-scrollbar)",{scrollbarWidth:"none"},[A("&::-webkit-scrollbar, &::-webkit-scrollbar-track-piece, &::-webkit-scrollbar-thumb",{width:0,height:0,display:"none"})])]),It=W({name:"VirtualList",inheritAttrs:!1,props:{showScrollbar:{type:Boolean,default:!0},columns:{type:Array,default:()=>[]},renderCol:Function,renderItemWithCols:Function,items:{type:Array,default:()=>[]},itemSize:{type:Number,required:!0},itemResizable:Boolean,itemsStyle:[String,Object],visibleItemsTag:{type:[String,Object],default:"div"},visibleItemsProps:Object,ignoreItemResize:Boolean,onScroll:Function,onWheel:Function,onResize:Function,defaultScrollKey:[Number,String],defaultScrollIndex:Number,keyField:{type:String,default:"key"},paddingTop:{type:[Number,String],default:0},paddingBottom:{type:[Number,String],default:0}},setup(n){const e=fe();ht.mount({id:"vueuc/virtual-list",head:!0,anchorMetaName:ce,ssr:e}),R(()=>{const{defaultScrollIndex:i,defaultScrollKey:f}=n;i!=null?a({index:i}):f!=null&&a({key:f})});let t=!1,r=!1;Pe(()=>{if(t=!1,!r){r=!0;return}a({top:c.value,left:p.value})}),qe(()=>{t=!0,r||(r=!0)});const o=D(()=>{if(n.renderCol==null&&n.renderItemWithCols==null||n.columns.length===0)return;let i=0;return n.columns.forEach(f=>{i+=f.width}),i}),u=H(()=>{const i=new Map,{keyField:f}=n;return n.items.forEach((g,M)=>{i.set(g[f],M)}),i}),{scrollLeftRef:p,listWidthRef:w}=ct({columnsRef:V(n,"columns"),renderColRef:V(n,"renderCol"),renderItemWithColsRef:V(n,"renderItemWithCols")}),s=I(null),h=I(void 0),m=new Map,y=H(()=>{const{items:i,itemSize:f,keyField:g}=n,M=new Ae(i.length,f);return i.forEach((S,T)=>{const $=S[g],E=m.get($);E!==void 0&&M.add(T,E)}),M}),d=I(0),c=I(0),v=D(()=>Math.max(y.value.getBound(c.value-he(n.paddingTop))-1,0)),b=H(()=>{const{value:i}=h;if(i===void 0)return[];const{items:f,itemSize:g}=n,M=v.value,S=Math.min(M+Math.ceil(i/g+1),f.length-1),T=[];for(let $=M;$<=S;++$)T.push(f[$]);return T}),a=(i,f)=>{if(typeof i=="number"){C(i,f,"auto");return}const{left:g,top:M,index:S,key:T,position:$,behavior:E,debounce:L=!0}=i;if(g!==void 0||M!==void 0)C(g,M,E);else if(S!==void 0)F(S,E,L);else if(T!==void 0){const re=u.value.get(T);re!==void 0&&F(re,E,L)}else $==="bottom"?C(0,Number.MAX_SAFE_INTEGER,E):$==="top"&&C(0,0,E)};let l,x=null;function F(i,f,g){const{value:M}=y,S=M.sum(i)+he(n.paddingTop);if(!g)s.value.scrollTo({left:0,top:S,behavior:f});else{l=i,x!==null&&window.clearTimeout(x),x=window.setTimeout(()=>{l=void 0,x=null},16);const{scrollTop:T,offsetHeight:$}=s.value;if(S>T){const E=M.get(i);S+E<=T+$||s.value.scrollTo({left:0,top:S+E-$,behavior:f})}else s.value.scrollTo({left:0,top:S,behavior:f})}}function C(i,f,g){s.value.scrollTo({left:i,top:f,behavior:g})}function ee(i,f){var g,M,S;if(t||n.ignoreItemResize||Y(f.target))return;const{value:T}=y,$=u.value.get(i),E=T.get($),L=(S=(M=(g=f.borderBoxSize)===null||g===void 0?void 0:g[0])===null||M===void 0?void 0:M.blockSize)!==null&&S!==void 0?S:f.contentRect.height;if(L===E)return;L-n.itemSize===0?m.delete(i):m.set(i,L-n.itemSize);const N=L-E;if(N===0)return;T.add($,N);const O=s.value;if(O!=null){if(l===void 0){const oe=T.sum($);O.scrollTop>oe&&O.scrollBy(0,N)}else if($<l)O.scrollBy(0,N);else if($===l){const oe=T.sum($);L+oe>O.scrollTop+O.offsetHeight&&O.scrollBy(0,N)}X()}d.value++}const U=!ft();let B=!1;function te(i){var f;(f=n.onScroll)===null||f===void 0||f.call(n,i),(!U||!B)&&X()}function ne(i){var f;if((f=n.onWheel)===null||f===void 0||f.call(n,i),U){const g=s.value;if(g!=null){if(i.deltaX===0&&(g.scrollTop===0&&i.deltaY<=0||g.scrollTop+g.offsetHeight>=g.scrollHeight&&i.deltaY>=0))return;i.preventDefault(),g.scrollTop+=i.deltaY/$e(),g.scrollLeft+=i.deltaX/$e(),X(),B=!0,Te(()=>{B=!1})}}}function K(i){if(t||Y(i.target))return;if(n.renderCol==null&&n.renderItemWithCols==null){if(i.contentRect.height===h.value)return}else if(i.contentRect.height===h.value&&i.contentRect.width===w.value)return;h.value=i.contentRect.height,w.value=i.contentRect.width;const{onResize:f}=n;f!==void 0&&f(i)}function X(){const{value:i}=s;i!=null&&(c.value=i.scrollTop,p.value=i.scrollLeft)}function Y(i){let f=i;for(;f!==null;){if(f.style.display==="none")return!0;f=f.parentElement}return!1}return{listHeight:h,listStyle:{overflow:"auto"},keyToIndex:u,itemsStyle:H(()=>{const{itemResizable:i}=n,f=_(y.value.sum());return d.value,[n.itemsStyle,{boxSizing:"content-box",width:_(o.value),height:i?"":f,minHeight:i?f:"",paddingTop:_(n.paddingTop),paddingBottom:_(n.paddingBottom)}]}),visibleItemsStyle:H(()=>(d.value,{transform:`translateY(${_(y.value.sum(v.value))})`})),viewportItems:b,listElRef:s,itemsElRef:I(null),scrollTo:a,handleListResize:K,handleListScroll:te,handleListWheel:ne,handleItemResize:ee}},render(){const{itemResizable:n,keyField:e,keyToIndex:t,visibleItemsTag:r}=this;return z(Me,{onResize:this.handleListResize},{default:()=>{var o,u;return z("div",Ue(this.$attrs,{class:["v-vl",this.showScrollbar&&"v-vl--show-scrollbar"],onScroll:this.handleListScroll,onWheel:this.handleListWheel,ref:"listElRef"}),[this.items.length!==0?z("div",{ref:"itemsElRef",class:"v-vl-items",style:this.itemsStyle},[z(r,Object.assign({class:"v-vl-visible-items",style:this.visibleItemsStyle},this.visibleItemsProps),{default:()=>{const{renderCol:p,renderItemWithCols:w}=this;return this.viewportItems.map(s=>{const h=s[e],m=t.get(h),y=p!=null?z(Se,{index:m,item:s}):void 0,d=w!=null?z(Se,{index:m,item:s}):void 0,c=this.$slots.default({item:s,renderedCols:y,renderedItemWithCols:d,index:m})[0];return n?z(Me,{key:h,onResize:v=>this.handleItemResize(h,v)},{default:()=>c}):(c.key=h,c)})}})]):(u=(o=this.$slots).empty)===null||u===void 0?void 0:u.call(o)])}})}}),pt=A(".v-x-scroll",{overflow:"auto",scrollbarWidth:"none"},[A("&::-webkit-scrollbar",{width:0,height:0})]),Ft=W({name:"XScroll",props:{disabled:Boolean,onScroll:Function},setup(){const n=I(null);function e(o){!(o.currentTarget.offsetWidth<o.currentTarget.scrollWidth)||o.deltaY===0||(o.currentTarget.scrollLeft+=o.deltaY+o.deltaX,o.preventDefault())}const t=fe();return pt.mount({id:"vueuc/x-scroll",head:!0,anchorMetaName:ce,ssr:t}),Object.assign({selfRef:n,handleWheel:e},{scrollTo(...o){var u;(u=n.value)===null||u===void 0||u.scrollTo(...o)}})},render(){return z("div",{ref:"selfRef",onScroll:this.onScroll,onWheel:this.disabled?void 0:this.handleWheel,class:"v-x-scroll"},this.$slots)}});function Le(n){return n instanceof HTMLElement}function ke(n){for(let e=0;e<n.childNodes.length;e++){const t=n.childNodes[e];if(Le(t)&&(He(t)||ke(t)))return!0}return!1}function Oe(n){for(let e=n.childNodes.length-1;e>=0;e--){const t=n.childNodes[e];if(Le(t)&&(He(t)||Oe(t)))return!0}return!1}function He(n){if(!mt(n))return!1;try{n.focus({preventScroll:!0})}catch{}return document.activeElement===n}function mt(n){if(n.tabIndex>0||n.tabIndex===0&&n.getAttribute("tabIndex")!==null)return!0;if(n.getAttribute("disabled"))return!1;switch(n.nodeName){case"A":return!!n.href&&n.rel!=="ignore";case"INPUT":return n.type!=="hidden"&&n.type!=="file";case"BUTTON":case"SELECT":case"TEXTAREA":return!0;default:return!1}}let j=[];const Bt=W({name:"FocusTrap",props:{disabled:Boolean,active:Boolean,autoFocus:{type:Boolean,default:!0},onEsc:Function,initialFocusTo:String,finalFocusTo:String,returnFocusOnDeactivated:{type:Boolean,default:!0}},setup(n){const e=Ve(),t=I(null),r=I(null);let o=!1,u=!1;const p=typeof document>"u"?null:document.activeElement;function w(){return j[j.length-1]===e}function s(a){var l;a.code==="Escape"&&w()&&((l=n.onEsc)===null||l===void 0||l.call(n,a))}R(()=>{P(()=>n.active,a=>{a?(y(),ue("keydown",document,s)):(q("keydown",document,s),o&&d())},{immediate:!0})}),Z(()=>{q("keydown",document,s),o&&d()});function h(a){if(!u&&w()){const l=m();if(l===null||l.contains(Xe(a)))return;c("first")}}function m(){const a=t.value;if(a===null)return null;let l=a;for(;l=l.nextSibling,!(l===null||l instanceof Element&&l.tagName==="DIV"););return l}function y(){var a;if(!n.disabled){if(j.push(e),n.autoFocus){const{initialFocusTo:l}=n;l===void 0?c("first"):(a=be(l))===null||a===void 0||a.focus({preventScroll:!0})}o=!0,document.addEventListener("focus",h,!0)}}function d(){var a;if(n.disabled||(document.removeEventListener("focus",h,!0),j=j.filter(x=>x!==e),w()))return;const{finalFocusTo:l}=n;l!==void 0?(a=be(l))===null||a===void 0||a.focus({preventScroll:!0}):n.returnFocusOnDeactivated&&p instanceof HTMLElement&&(u=!0,p.focus({preventScroll:!0}),u=!1)}function c(a){if(w()&&n.active){const l=t.value,x=r.value;if(l!==null&&x!==null){const F=m();if(F==null||F===x){u=!0,l.focus({preventScroll:!0}),u=!1;return}u=!0;const C=a==="first"?ke(F):Oe(F);u=!1,C||(u=!0,l.focus({preventScroll:!0}),u=!1)}}}function v(a){if(u)return;const l=m();l!==null&&(a.relatedTarget!==null&&l.contains(a.relatedTarget)?c("last"):c("first"))}function b(a){u||(a.relatedTarget!==null&&a.relatedTarget===t.value?c("last"):c("first"))}return{focusableStartRef:t,focusableEndRef:r,focusableStyle:"position: absolute; height: 0; width: 0;",handleStartFocus:v,handleEndFocus:b}},render(){const{default:n}=this.$slots;if(n===void 0)return null;if(this.disabled)return n();const{active:e,focusableStyle:t}=this;return z(ze,null,[z("div",{"aria-hidden":"true",tabindex:e?"0":"-1",ref:"focusableStartRef",style:t,onFocus:this.handleStartFocus}),n(),z("div",{"aria-hidden":"true",style:t,ref:"focusableEndRef",tabindex:e?"0":"-1",onFocus:this.handleEndFocus})])}});export{Tt as B,Bt as F,nt as L,Me as V,It as a,Et as b,zt as c,Ft as d,xe as r};
