import{m as I,r as P,p as g,O as v,P as O}from"./@vue.8936e839.js";import{c as T,a as E,b as H}from"./vue-router.fb34c92e.js";import{c as L}from"./@vueuse.f97b4275.js";function M(t){try{return JSON.parse(t||"{}")}catch(e){return console.error("[SSG] On state deserialization -",e,t),{}}}function N(t){return document.readyState==="loading"?new Promise(e=>{document.addEventListener("DOMContentLoaded",()=>e(t))}):Promise.resolve(t)}const x=I({setup(t,{slots:e}){const o=P(!1);return g(()=>o.value=!0),()=>o.value?e.default&&e.default({}):e.placeholder&&e.placeholder({})}});function J(t,e,o,y={}){const{transformState:s,registerComponents:w=!0,useHead:h=!0,rootContainer:A="#app"}=y,l=typeof window<"u";async function S(r=!1,c){var R;const u=r?v(t):O(t);let d;h&&(d=L(),u.use(d));const i=T({history:r?E(e.base):H(e.base),...e}),{routes:_}=e;w&&u.component("ClientOnly",x);const m=[],n={app:u,head:d,isClient:l,router:i,routes:_,onSSRAppRendered:r?()=>{}:a=>m.push(a),triggerOnSSRAppRendered:()=>Promise.all(m.map(a=>a())),initialState:{},transformState:s,routePath:c};r&&(await N(),n.initialState=(s==null?void 0:s(window.__INITIAL_STATE__||{}))||M(window.__INITIAL_STATE__)),await(o==null?void 0:o(n)),u.use(i);let p,f=!0;if(i.beforeEach((a,V,b)=>{(f||p&&p===a.path)&&(f=!1,p=a.path,a.meta.state=n.initialState),b()}),!r){const a=(R=n.routePath)!=null?R:"/";i.push(a),await i.isReady(),n.initialState=i.currentRoute.value.meta.state||{}}const C=n.initialState;return{...n,initialState:C}}return l&&(async()=>{const{app:r,router:c}=await S(!0);await c.isReady(),r.mount(A,!0)})(),S}export{J as V};
